<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>企业估值计算器</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>企业估值计算器</h1>
        
        <div class="stock-search-section">
            <label for="stock-name" class="search-label">股票名称/代码</label>
            <div class="search-wrapper">
                <input type="text" id="stock-name" placeholder="输入股票名称或代码（如：天齐锂业、002466）">
                <button type="button" id="search-stock-btn" class="search-btn">搜索</button>
            </div>
            <div class="stock-hint">支持所有A股上市公司，输入股票代码（6位数字）即可获取财报数据</div>
            <div id="data-source-info" class="data-source-info" style="display: none;"></div>
            <div id="stock-suggestions" class="stock-suggestions"></div>
            <div id="stock-loading" class="loading" style="display: none;">正在获取财报数据...</div>
        </div>

        <div class="pdf-upload-section">
            <label for="pdf-file" class="search-label">上传财报PDF文件</label>
            <div class="search-wrapper">
                <input type="file" id="pdf-file" accept=".pdf">
                <button type="button" id="upload-pdf-btn" class="search-btn">解析PDF</button>
            </div>
            <div class="stock-hint">支持PDF格式的财报文件，系统将自动解析并提取财务数据</div>
            <div id="pdf-loading" class="loading" style="display: none;">正在解析PDF文件...</div>
            <div id="pdf-error" class="error-message" style="display: none;"></div>
        </div>

        <form id="valuation-form">
            <!-- 参数输入将在这里 -->
            <div>
                <label for="cash">现金 (账面值)</label>
                <input type="number" id="cash" value="0" step="any">
                <span class="suggested-value" id="suggested-cash"></span>
            </div>
            <div>
                <label for="accounts-receivable">应收账款</label>
                <input type="number" id="accounts-receivable" value="0" step="any">
                <span class="suggested-value" id="suggested-accounts-receivable"></span>
            </div>
            <div>
                <label for="credit-loss-rate">预期信用损失率 (%)</label>
                <input type="number" id="credit-loss-rate" value="0" step="any">
                <span class="suggested-value" id="suggested-credit-loss-rate"></span>
            </div>
            <div>
                <label for="notes-receivable">减值后的应收票据</label>
                <input type="number" id="notes-receivable" value="0" step="any">
                <span class="suggested-value" id="suggested-notes-receivable"></span>
            </div>
            <div>
                <label for="inventory">计提损失后的存货价值</label>
                <input type="number" id="inventory" value="0" step="any">
                <span class="suggested-value" id="suggested-inventory"></span>
            </div>
            <div>
                <label for="trading-financial-assets">交易性金融资产的当前价值</label>
                <input type="number" id="trading-financial-assets" value="0" step="any">
                <span class="suggested-value" id="suggested-trading-financial-assets"></span>
            </div>
            <div>
                <label for="other-current-assets">其他流动资产 (账面值)</label>
                <input type="number" id="other-current-assets" value="0" step="any">
                <span class="suggested-value" id="suggested-other-current-assets"></span>
            </div>
            <div>
                <label for="non-current-assets-due-within-one-year">一年内到期的非流动资产 (账面值)</label>
                <input type="number" id="non-current-assets-due-within-one-year" value="0" step="any">
                <span class="suggested-value" id="suggested-non-current-assets-due-within-one-year"></span>
            </div>
            <div>
                <label for="plant-depreciation-coefficient">厂房/折旧系数</label>
                <input type="number" id="plant-depreciation-coefficient" value="0" step="any">
                <span class="suggested-value" id="suggested-plant-depreciation-coefficient"></span>
            </div>
            <div>
                <label for="machinery-depreciation-coefficient">生产机器设备/折旧系数</label>
                <input type="number" id="machinery-depreciation-coefficient" value="0" step="any">
                <span class="suggested-value" id="suggested-machinery-depreciation-coefficient"></span>
            </div>
            <div>
                <label for="construction-in-progress">在建工程账面价值</label>
                <input type="number" id="construction-in-progress" value="0" step="any">
                <span class="suggested-value" id="suggested-construction-in-progress"></span>
            </div>
            <div>
                <label for="land-book-value">土地账面价值</label>
                <input type="number" id="land-book-value" value="0" step="any">
                <span class="suggested-value" id="suggested-land-book-value"></span>
            </div>
            <div>
                <label for="land-value-coefficient">还原到当下土地价值系数</label>
                <input type="number" id="land-value-coefficient" value="0" step="any">
                <span class="suggested-value" id="suggested-land-value-coefficient"></span>
            </div>
            <div>
                <label for="goodwill">商誉 (账面值)</label>
                <input type="number" id="goodwill" value="0" step="any">
                <span class="suggested-value" id="suggested-goodwill"></span>
            </div>
            <div>
                <label for="company-type">企业类型</label>
                <select id="company-type">
                    <option value="cyclical-resource">周期资源股</option>
                    <option value="consumer">消费股</option>
                    <option value="real-estate">地产股</option>
                </select>
                <span class="suggested-value" id="suggested-company-type"></span>
            </div>
            <div id="cyclical-resource-fields">
                <div>
                    <label for="patent-technology-value-cyclical">专利技术价值</label>
                    <input type="number" id="patent-technology-value-cyclical" value="0" step="any">
                    <span class="suggested-value" id="suggested-patent-technology-value-cyclical"></span>
                </div>
                <div>
                    <label for="mineral-rights-value">矿产权益价值</label>
                    <input type="number" id="mineral-rights-value" value="0" step="any">
                    <span class="suggested-value" id="suggested-mineral-rights-value"></span>
                </div>
            </div>
            <div id="consumer-fields" style="display:none;">
                <div>
                    <label for="patent-technology-value-consumer">专利技术价值</label>
                    <input type="number" id="patent-technology-value-consumer" value="0" step="any">
                    <span class="suggested-value" id="suggested-patent-technology-value-consumer"></span>
                </div>
                <div>
                    <label for="product-portfolio-value">产品组合价值</label>
                    <input type="number" id="product-portfolio-value" value="0" step="any">
                    <span class="suggested-value" id="suggested-product-portfolio-value"></span>
                </div>
                <div>
                    <label for="trained-staff-value">训练有素的员工价值</label>
                    <input type="number" id="trained-staff-value" value="0" step="any">
                    <span class="suggested-value" id="suggested-trained-staff-value"></span>
                </div>
                <div>
                    <label for="customer-relationship-value">客户关系价值</label>
                    <input type="number" id="customer-relationship-value" value="0" step="any">
                    <span class="suggested-value" id="suggested-customer-relationship-value"></span>
                </div>
            </div>
            <div>
                <label for="debt">债务</label>
                <input type="number" id="debt" value="0" step="any">
                <span class="suggested-value" id="suggested-debt"></span>
            </div>
            <button type="submit">计算估值</button>
        </form>
        <div id="result">
            <h2>估值结果</h2>
            <p class="result-label">再生产价值</p>
            <p class="result-value" id="reproduction-value">0</p>
            <p class="result-label">合理买入价格</p>
            <p class="result-value" id="reasonable-price">0</p>
        </div>
        <div id="calculation-process">
            <h2>计算过程</h2>
            <div id="calculation-steps"></div>
        </div>

        <div class="quantitative-analysis-section">
            <h2>量化分析</h2>
            <div class="stock-info-display">
                <div class="info-item">
                    <span class="info-label">股票代码</span>
                    <span class="info-value" id="qa-stock-code">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">股票名称</span>
                    <span class="info-value" id="qa-stock-name">-</span>
                </div>
                <div class="info-item">
                    <span class="info-label">实时股价</span>
                    <span class="info-value" id="qa-stock-price">-</span>
                </div>
            </div>
            <div class="model-info">
                <div class="model-name">
                    <span class="model-label">量化模型</span>
                    <span class="model-value">MACD + RSI 综合策略</span>
                </div>
                <div class="model-source">
                    <span class="model-label">模型来源</span>
                    <span class="model-value">基于技术分析经典指标</span>
                </div>
            </div>
            <button type="button" id="analyze-btn" class="analyze-btn">开始量化分析</button>
            <div id="qa-loading" class="loading" style="display: none;">正在分析...</div>
            <div id="qa-result" class="qa-result" style="display: none;">
                <div class="decision-display">
                    <span class="decision-label">交易决策</span>
                    <span class="decision-value" id="decision-value"></span>
                </div>
                <div class="analysis-process" id="analysis-process" style="display: none;">
                    <h3>分析过程</h3>
                    <div id="analysis-steps"></div>
                </div>
                <div class="indicators-display">
                    <h3>技术指标</h3>
                    <div class="indicator-item">
                        <span class="indicator-label">MACD</span>
                        <span class="indicator-value" id="macd-value"></span>
                    </div>
                    <div class="indicator-item">
                        <span class="indicator-label">RSI(14)</span>
                        <span class="indicator-value" id="rsi-value"></span>
                    </div>
                    <div class="indicator-item">
                        <span class="indicator-label">MA5</span>
                        <span class="indicator-value" id="ma5-value"></span>
                    </div>
                    <div class="indicator-item">
                        <span class="indicator-label">MA10</span>
                        <span class="indicator-value" id="ma10-value"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>